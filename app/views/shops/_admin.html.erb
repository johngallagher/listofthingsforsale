<!-- Elements:

1. Sign up (if no user for shop)
2. Resend verification code (if verification is in process)
3. Change password/email address (if user signed in and verification not in process)
4. Change URL (always)

If user is not signed in and no user for shop: 1,4
If user is being verified: 2,4
If user is signed in: 3,4
If user is not signed in but shop has user: 4 -->
<script type="text/javascript" charset="utf-8">
	function submitForm() {
		$("form.edit_shop").submit();
	};
	function changeItemPhoto() {
		itemIdToChange = $("select#item_image_name_item_image_id").val()
		$("form.edit_item").attr("action","/items/" + itemIdToChange);
		$(".photo_selector").show();
	}
</script>

<h2>Admin area</h2>

<h2>Image Upload</h2>
<%= select :item_image_name, :item_image_id, Item.where(:shop_id => @shop.id).all.collect {|p| [ p.name, p.id ] }, options = {:onChange => "changeItemPhoto()", :include_blank => 'Select item'}, html_options = {:onChange => "changeItemPhoto()"} %>

<% form_for @item, :html => { :multipart => true }, :remote => true do |f| %>
  <div class="photo_selector" style="display: none;">
    <%= f.label :photo_1, :class => 'required' %><br />
    <%= f.file_field :photo_1, :required => true %>
		<%= f.submit %>
  </div>

<% end %>

<!-- 1. Sign Up -->
<% if !user_signed_in? and @shop.user_id.nil? %>
	<%= render 'devise/registrations/new_short' %>
<% end %>


<!-- 2. Verification resend -->
<% if !@shop.user_id.nil? %>
	<% if !User.find(@shop.user_id).confirmation_token.nil? %>
		<%= render 'devise/confirmations/new' %>
	<% end %>
<% end %>

<!-- 3. Change password and email address -->

<% if user_signed_in? %>
  Signed in as <%= current_user.email %>. Not you?
  <%= link_to "Sign out", destroy_user_session_path, :method => :delete %>
	Change Password/Email address area.
<% end %>

<!-- 4. Change url -->

<%= render :partial => "public_url" %>


<h2>Settings</h2>
<% form_for @shop, :remote => true do |f| %>
  <div class="field">

	  <p>
	    <%= f.label "Payment" %><br />
			<%= f.check_box :payment_type , :onClick => "submitForm()" %>
		  <%= f.label :payment_type_paypal, 'Use Paypal', :value => "paypal" %>
		</p>
	  <p>
	    <%= f.label :paypal_email %><br />
	    <%= f.text_field :paypal_email, :onBlur => "submitForm()" %>
	  </p>
	  <p>
	    <%= f.label :payment_other_text %><br />
	    <%= f.text_area :payment_other_text, :onBlur => "submitForm()" %>
	  </p>


	  <p>
	    <%= f.label "Delivery" %><br />
		  <%= f.radio_button :delivery_method, 'post', :checked => true %> 
		  <%= f.label :delivery_method_post, 'Post', :value => "post" %>
		  <%= f.radio_button :delivery_method, 'collection' %>
		  <%= f.label :delivery_method_other, 'Collection', :value => "collection" %>
		s</p>
		
	  <p>
	    <%= f.label "Postage Included" %><br />
	    <%= f.check_box :prices_include_postage, :checked => true  %>
	  </p>
	  <p>
	    <%= f.label :postage_price %><br />
	    <%= f.text_field :postage_price, :onBlur => "submitForm()"  %>
	  </p>

	  <p>
		  <%= f.radio_button :postage_type, 'flat_rate', :checked => true %> 
		  <%= f.label :postage_type_flat, 'Flat Rate', :value => "flat_rate" %>
		  <%= f.radio_button :postage_type, 'per_item' %>
		  <%= f.label :postage_type_per_item, 'Per Item', :value => "per_item" %>
		</p>
  </div>
<% end %>



<h2>Now make it your own</h2>

